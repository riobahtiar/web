---
import { Icon } from "astro-icon/components";

interface Props {
  title: string;
  open?: boolean;
  variant?: "default" | "bordered" | "ghost";
}

const { title, open = false, variant = "default" } = Astro.props;

// Generate unique ID for accordion
const id = `accordion-${Math.random().toString(36).substring(2, 11)}`;

const variantStyles = {
  default: "bg-base-200",
  bordered: "border-2 border-base-300",
  ghost: "bg-transparent",
};
---

<details class={`accordion-item my-4 rounded-lg ${variantStyles[variant]}`} open={open}>
  <summary class="accordion-header cursor-pointer p-4 font-semibold text-base-content hover:bg-base-300 transition-colors rounded-lg flex items-center justify-between group">
    <span class="flex-1">{title}</span>
    <Icon
      name="tabler:chevron-down"
      class="h-5 w-5 text-base-content/60 transition-transform group-open:rotate-180"
    />
  </summary>

  <div class="accordion-content p-4 pt-0">
    <div class="prose prose-sm max-w-none text-base-content/90">
      <slot />
    </div>
  </div>
</details>

<style>
  .accordion-item summary {
    list-style: none;
  }

  .accordion-item summary::-webkit-details-marker {
    display: none;
  }

  .accordion-content :global(p:first-child) {
    margin-top: 0;
  }

  .accordion-content :global(p:last-child) {
    margin-bottom: 0;
  }
</style>

<script is:inline>
  // Add smooth animation when opening/closing
  document.querySelectorAll('.accordion-item').forEach(details => {
    const content = details.querySelector('.accordion-content');
    if (content) {
      details.addEventListener('toggle', () => {
        if ((details as HTMLDetailsElement).open) {
          (content as HTMLElement).style.animation = 'slideDown 0.3s ease-out';
        }
      });
    }
  });
</script>
